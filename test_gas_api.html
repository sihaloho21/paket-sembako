<!DOCTYPE html>
<html>
<head>
    <title>Test Google Apps Script API</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        #result { margin-top: 20px; padding: 10px; background: #f5f5f5; border-radius: 5px; white-space: pre-wrap; }
        .error { background: #ffebee; color: #c62828; }
        .success { background: #e8f5e9; color: #2e7d32; }
    </style>
</head>
<body>
    <h1>Test Google Apps Script API</h1>
    <p><strong>API URL:</strong> https://script.google.com/macros/s/AKfycbxPlWkZ2AqFgo0-AfK02wIcrQ1HG7B9bIh1UCCcZqW9t79wh4uzNC8Lxxq-o8ybPa1b/exec</p>
    
    <div>
        <button onclick="testRead('products')">Test Read Products</button>
        <button onclick="testRead('orders')">Test Read Orders</button>
        <button onclick="testRead('categories')">Test Read Categories</button>
        <button onclick="testRead('Sheet1')">Test Read Sheet1</button>
    </div>
    
    <div id="result"></div>

    <script>
        const API_URL = 'https://script.google.com/macros/s/AKfycbxPlWkZ2AqFgo0-AfK02wIcrQ1HG7B9bIh1UCCcZqW9t79wh4uzNC8Lxxq-o8ybPa1b/exec';
        
        async function testRead(sheetName) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `Testing read from sheet: ${sheetName}...`;
            resultDiv.className = '';
            
            try {
                const url = `${API_URL}?action=read&sheet=${sheetName}`;
                console.log('Fetching:', url);
                
                const response = await fetch(url);
                console.log('Response status:', response.status);
                console.log('Response headers:', [...response.headers.entries()]);
                
                const text = await response.text();
                console.log('Response text:', text);
                
                const data = JSON.parse(text);
                console.log('Parsed data:', data);
                
                if (data.success) {
                    resultDiv.className = 'success';
                    resultDiv.innerHTML = `✅ SUCCESS!\n\nSheet: ${sheetName}\nRecords: ${data.data ? data.data.length : 0}\n\nData:\n${JSON.stringify(data.data, null, 2)}`;
                } else {
                    resultDiv.className = 'error';
                    resultDiv.innerHTML = `❌ FAILED!\n\nMessage: ${data.message}\n\nFull Response:\n${JSON.stringify(data, null, 2)}`;
                }
            } catch (error) {
                console.error('Error:', error);
                resultDiv.className = 'error';
                resultDiv.innerHTML = `❌ ERROR!\n\n${error.message}\n\nStack:\n${error.stack}`;
            }
        }
    </script>
</body>
</html>
